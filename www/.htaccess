php_value max_input_vars 4000
#php_value upload_max_filesize 3M
##
# @package    Joomla
# @copyright  Copyright (C) 2005 - 2014 Open Source Matters. All rights reserved.
# @license    GNU General Public License version 2 or later; see LICENSE.txt
##

##
# READ THIS COMPLETELY IF YOU CHOOSE TO USE THIS FILE!
#
# The line just below this section: 'Options +FollowSymLinks' may cause problems
# with some server configurations.  It is required for use of mod_rewrite, but may already
# be set by your server administrator in a way that dissallows changing it in
# your .htaccess file.  If using it causes your server to error out, comment it out (add # to
# beginning of line), reload your site in your browser and test your sef url's.  If they work,
# it has been set by your server administrator and you do not need it set here.
##
## No directory listings
<IfModule autoindex>
  IndexIgnore *
</IfModule>

## Can be commented out if causes errors, see notes above.
##Options +FollowSymlinks
Options -Indexes

## Mod_rewrite in use.

RewriteEngine On

## Begin - Rewrite rules to block out some common exploits.
# If you experience problems on your site block out the operations listed below
# This attempts to block the most common type of exploit `attempts` to Joomla!
#
# Block out any script trying to base64_encode data within the URL.
RewriteCond %{QUERY_STRING} base64_encode[^(]*\([^)]*\) [OR]
# Block out any script that includes a <script> tag in URL.
RewriteCond %{QUERY_STRING} (<|%3C)([^s]*s)+cript.*(>|%3E) [NC,OR]
# Block out any script trying to set a PHP GLOBALS variable via URL.
RewriteCond %{QUERY_STRING} GLOBALS(=|\[|\%[0-9A-Z]{0,2}) [OR]
# Block out any script trying to modify a _REQUEST variable via URL.
RewriteCond %{QUERY_STRING} _REQUEST(=|\[|\%[0-9A-Z]{0,2})
# Return 403 Forbidden header and show the content of the root homepage
RewriteRule .* index.php [F]
#
## End - Rewrite rules to block out some common exploits.

## Begin - Custom redirects
#
# If you need to redirect some pages, or set a canonical non-www to
# www redirect (or vice versa), place that code here. Ensure those
# redirects use the correct RewriteRule syntax and the [R=301,L] flags.
#
RewriteRule ^/?sites/new.html /browse-sites/newest-first.html [R=301,L]
RewriteRule ^/?sites/featured.html /browse-sites/featured.html [R=301,L]
RewriteRule ^/?sites/most-rated.html /browse-sites/most-reviewed.html [R=301,L]
RewriteRule ^/?sites/top-rated.html /browse-sites/highest-rating.html [R=301,L]
RewriteRule ^/?sites.html / [R=301,L]

RewriteRule sites/arts /browse-sites.html?item_category_frontend=34 [R=301,L]
RewriteRule sites/business /browse-sites.html?item_category_frontend=35 [R=301,L]
RewriteRule sites/educational /browse-sites.html?item_category_frontend=36 [R=301,L]
RewriteRule sites/government-and-nonprofit /browse-sites.html?item_category_frontend=40 [R=301,L]
RewriteRule sites/health /browse-sites.html?item_category_frontend=41 [R=301,L]
RewriteRule sites/news-a-media /browse-sites.html?item_category_frontend=44 [R=301,L]
RewriteRule sites/personal /browse-sites.html?item_category_frontend=45 [R=301,L]
RewriteRule sites/recreation-and-hobbies /browse-sites.html [R=301,L]
RewriteRule sites/reference /browse-sites.html [R=301,L]
RewriteRule sites/science /browse-sites.html?item_category_frontend=46 [R=301,L]
RewriteRule sites/society /browse-sites.html?item_category_frontend=47 [R=301,L]
RewriteRule sites/sports /browse-sites.html?item_category_frontend=48 [R=301,L]
RewriteRule sites/technology /browse-sites.html?item_category_frontend=49 [R=301,L]

RewriteRule sites/searchby /browse-sites.html [R=301,L]

RewriteRule ^/?how-to-submit-a-site.html /submit-a-site.html [R=301,L]
RewriteRule ^/?showcase-guidelines.html /about-jsd/faqs.html [R=301,L]
RewriteRule ^/?disclaimer.html /about-jsd/disclaimer.html [R=301,L]

RewriteRule ^/?component/user/reset.html /user-login.html?view=reset [R=301,L]
RewriteRule ^/?component/user/remind.html /user-login.html?view=remind [R=301,L]
RewriteRule ^/?component/user/register.html /register [R=301,L]

## End - Custom redirects

##
# Uncomment following line if your webserver's URL
# is not directly related to physical file paths.
# Update Your Joomla! Directory (just / for root).
##

RewriteBase /

## Begin - Joomla! core SEF Section.
#
RewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]
#
# If the requested path and file is not /index.php and the request
# has not already been internally rewritten to the index.php script
RewriteCond %{REQUEST_URI} !^/index\.php
# and the requested path and file doesn't directly match a physical file
RewriteCond %{REQUEST_FILENAME} !-f
# and the requested path and file doesn't directly match a physical folder
RewriteCond %{REQUEST_FILENAME} !-d
# internally rewrite the request to the index.php script
RewriteRule .* index.php [L]
#
## End - Joomla! core SEF Section.

##################### Security Header #####################
<IfModule mod_headers.c>
  # X-XSS-Protection
  Header always set X-XSS-Protection "1; mode=block"
  # X-Frame-Options
  Header always set X-Frame-Options SAMEORIGIN ALLOW-FROM https://joomla.org.au/
  # X-Content-Type nosniff
  Header always set X-Content-Type-Options nosniff
  # Referrer-Policy
  Header always set Referrer-Policy "no-referrer-when-downgrade"
  # Strict-Transport-Security
  Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains"
# Content-Security-Policy-Report-Only 
  Header always set Content-Security-Policy "default-src 'self'; script-src 'self' https://*.joomla.org https://hcaptcha.com https://*.hcaptcha.com 'unsafe-inline' 'unsafe-eval' https://*.googletagservices.com https://*.google.ac https://*.google.ad https://*.google.ae https://*.google.al https://*.google.am https://*.google.as https://*.google.at https://*.google.az https://*.google.ba https://*.google.be https://*.google.bf https://*.google.bg https://*.google.bi https://*.google.bj https://*.google.bs https://*.google.bt https://*.google.by https://*.google.ca https://*.google.cat https://*.google.cc https://*.google.cd https://*.google.cf https://*.google.cg https://*.google.ch https://*.google.ci https://*.google.cl https://*.google.cm https://*.google.cn https://*.google.co.ao https://*.google.co.bw https://*.google.co.ck https://*.google.co.cr https://*.google.co.id https://*.google.co.il https://*.google.co.in https://*.google.co.jp https://*.google.co.ke https://*.google.co.kr https://*.google.co.ls https://*.google.co.ma https://*.google.co.mz https://*.google.co.nz https://*.google.co.th https://*.google.co.tz https://*.google.co.ug https://*.google.co.uk https://*.google.co.uz https://*.google.co.ve https://*.google.co.vi https://*.google.co.za https://*.google.co.zm https://*.google.co.zw https://*.google.com https://*.google.com.af https://*.google.com.ag https://*.google.com.ai https://*.google.com.ar https://*.google.com.au https://*.google.com.bd https://*.google.com.bh https://*.google.com.bn https://*.google.com.bo https://*.google.com.br https://*.google.com.bz https://*.google.com.co https://*.google.com.cu https://*.google.com.cy https://*.google.com.do https://*.google.com.ec https://*.google.com.eg https://*.google.com.et https://*.google.com.fj https://*.google.com.gh https://*.google.com.gi https://*.google.com.gt https://*.google.com.hk https://*.google.com.jm https://*.google.com.kh https://*.google.com.kw https://*.google.com.lb https://*.google.com.lc https://*.google.com.ly https://*.google.com.mm https://*.google.com.mt https://*.google.com.mx https://*.google.com.my https://*.google.com.na https://*.google.com.nf https://*.google.com.ng https://*.google.com.ni https://*.google.com.np https://*.google.com.om https://*.google.com.pa https://*.google.com.pe https://*.google.com.pg https://*.google.com.ph https://*.google.com.pk https://*.google.com.pr https://*.google.com.py https://*.google.com.qa https://*.google.com.sa https://*.google.com.sb https://*.google.com.sg https://*.google.com.sl https://*.google.com.sv https://*.google.com.tj https://*.google.com.tr https://*.google.com.tw https://*.google.com.ua https://*.google.com.uy https://*.google.com.vc https://*.google.com.vn https://*.google.cv https://*.google.cz https://*.google.de https://*.google.dj https://*.google.dk https://*.google.dm https://*.google.dz https://*.google.ee https://*.google.es https://*.google.fi https://*.google.fm https://*.google.fr https://*.google.ga https://*.google.ge https://*.google.gf https://*.google.gg https://*.google.gl https://*.google.gm https://*.google.gp https://*.google.gr https://*.google.gy https://*.google.hn https://*.google.hr https://*.google.ht https://*.google.hu https://*.google.ie https://*.google.im https://*.google.io https://*.google.iq https://*.google.is https://*.google.it https://*.google.je https://*.google.jo https://*.google.kg https://*.google.ki https://*.google.kz https://*.google.la https://*.google.li https://*.google.lk https://*.google.lt https://*.google.lu https://*.google.lv https://*.google.md https://*.google.me https://*.google.mg https://*.google.mk https://*.google.ml https://*.google.mn https://*.google.ms https://*.google.mu https://*.google.mv https://*.google.mw https://*.google.ne https://*.google.nl https://*.google.no https://*.google.nr https://*.google.nu https://*.google.pl https://*.google.pn https://*.google.ps https://*.google.pt https://*.google.ro https://*.google.rs https://*.google.ru https://*.google.rw https://*.google.sc https://*.google.se https://*.google.sh https://*.google.si https://*.google.sk https://*.google.sm https://*.google.sn https://*.google.so https://*.google.sr https://*.google.st https://*.google.td https://*.google.tg https://*.google.tk https://*.google.tl https://*.google.tm https://*.google.tn https://*.google.to https://*.google.tt https://*.google.vg https://*.google.vu https://*.google.ws https://*.googlesyndication.com https://*.google-analytics.com https://*.googlesyndication.com https://*.googletagmanager.com https://*.googleapis.com https://*.gstatic.com https://*.google.com https://ads.joomla.org https://*.pingdom.net https://*.twitter.com https://*.twimg.com https://*.facebook.net https://*.facebook.com https://*.googleapis.com https://*.ostraining.com https://ostraining.com https://*.wistia.com https://*.wistia.net https://*.litix.io https://*.doubleclick.net https://*.spreadshirt.ie https://*.spreadshirts.net https://*.spreadshirt.net https://unpkg.com; style-src 'self' 'unsafe-inline' https://*.joomla.org https://hcaptcha.com https://*.hcaptcha.com https://*.googlesyndication.com https://*.googleapis.com https://*.ostraining.com https://ostraining.com https://*.twitter.com https://*.twimg.com https://*.spreadshirt.ie https://unpkg.com; connect-src 'self' https://*.googlesyndication.com https://*.pingdom.net https://*.wistia.com https://*.litix.io https://*.doubleclick.net https://*.akamaihd.net https://*.litix.io https://*.google-analytics.com https://*.ostraining.com https://ostraining.com https://*.twitter.com https://shop.spreadshirt.ie https://*.spreadshirt.net; frame-src 'self' https://*.joomla.org https://hcaptcha.com https://*.hcaptcha.com https://googleads.g.doubleclick.net/ https://googleads.g.doubleclick.net https://*.googlesyndication.com https://*.slideshare.net https://*.twimg.com https://*.adfront.org https://*.twitter.com https://*.facebook.net https://*.facebook.com https://*.wistia.com https://*.google.com https://*.googletagmanager.com https://*.youtube.com https://*.slideshare.net https://*.vimeo.com https://*.spreadshirt.ie https://*.spreadshirtsandbox.net/; font-src 'self' data: https://*.googlesyndication.com https://*.gstatic.com https://*.joomla.org https://*.ostraining.com https://ostraining.com https://*.spreadshirt.ie; img-src 'self' data: https:; media-src 'self' blob: https://*.googlesyndication.com https://*.akamaihd.net https://*.wistia.net https://*.wistia.com; worker-src 'self' blob: https://*.googlesyndication.com https://*.wistia.com; object-src 'self' https://*.googlesyndication.com https://*.macromedia.com https://embedwistia-a.akamaihd.net https://*.youtube-nocookie.com; frame-ancestors 'self' *.joomla.org https://joomla.org.au; report-uri https://community.joomla.org/scripts/csp-reporter.php?source=showcase.joomla.org"
</IfModule>
## Since Joomla 3.9.21
## Disable inline JavaScript when directly opening SVG files or embedding them with the object-tag
<FilesMatch "\.svg$">
  <IfModule mod_headers.c>
    Header always set Content-Security-Policy "script-src 'none'"
  </IfModule>
</FilesMatch>
##################### Security Header #####################
